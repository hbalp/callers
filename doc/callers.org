#+AUTHOR Hugues Balp
#+TITLE The Callers plug-in

* TODO The Callers plug-in [2/7]
  :PROPERTIES:
  :author:   Hugues Balp
  :partner:  Thales Communications & Security
  :version:  0.1
  :END:
** Header
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
#+AUTHOR Hugues Balp
#+TITLE The Callers plug-in
The Callers plug-in
   #+END_SRC
** DONE Introduction/Executive Summary [1/1]
   - [X] Introduce the plugin
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
   Callers is a static analysis plugin extending the clang/LLVM compilation framework for enabling early syntactic-based security analysis on large-scale C/C++ software.
   #+END_SRC
** DONE Aims [1/1]
   - [X] Describe the objectives of the plug-in and its relation with the security analysis of source code (what security properties are analysed)   
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
* Aim
   The initial goal of the Callers plugin is to enable early security risks assessments based on the analysis of function calls dependencies.

   This plugin is extensible and it could also be completed in the future to support other types of dependencies like:
   - data type dependencies (inheritence, composition...)
   - control-flow dependencies (behavioral analysis based on sequence diagram generation)
   - use of shared variables
   - use of vulnerable system calls (related to specific CVEs)

   The main idea behind the Callers plugin is to perform some kind of global static link edition of the whole software
   in order to be able to capture all the possible execution paths of the software and the different usage contexts of each function.

   Based on this information, the tool can generate different instances of function callgraphs, depending on the end-user analysis focus.
   Those callgraphs can then been further exploited to enable the verification of some global security properties on the software.
   #+END_SRC
** TODO Functioning and user interface [0/1]
   - [ ] Describe the main functions of the plug-in and its user interface, if any.
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
* Functioning and user interface
   TBC
   Function call dependencies can be analyzed at different granularity levels (function, file, directory, libraries, application).
   #+END_SRC
** TODO Implementation [0/3]
   Describe the internals of the plug-in
*** TODO architecture of the plugin
    #+BEGIN_SRC dot :tangle callers.frontend.internals.gen.dot
digraph "Callers integration with Clang/LLVM " 
{

"scan-build" [ label="clang scan-build" ]
"scan-callers" [ label="STANCE scan-callers" ]
"cmake-callers" [ label="STANCE cmake-callers" ]
"scan-callers" -> "scan-build" [ label="extends" ]

// user build
"user build" [ label="custom build\n(autoconf, cmake..)" ]
"scan-build" -> "user build"

// compilation
"object code" [ shape="box" ]

// c compilation
"c code" [ label="C code", shape="box" ]
"c compiler" [ label="C compiler\n(gcc, clang..)" ]
"user build" -> "c compiler"
"c compiler" -> "c code" [ dir=back ]
"c compiler" -> "object code"

// c++ compilation
"cpp code" [ label="C++ code", shape="box" ]
"cpp compiler" [ label="C++ compiler\n(g++,clang++..)" ]
"user build" -> "cpp compiler"
"cpp compiler" -> "cpp code" [ dir=back ]
"cpp compiler" -> "object code"

// cmake build
"cmake-callers" -> "cmake build"
"cmake build" -> "cpp compiler"
"cmake build" -> "c compiler"

// cmake callers analysis
"cmake-callers" -> "callers frontend"
"cmake-callers" -> "callers++ frontend"
"cmake-callers" -> "frama-c++"

// clang compilation
"clang object code" [ label="Clang/LLVM object code", shape="box" ]
"llvm" [ label="LLVM Optimizer\n& Code Generator" ]
"llvm" -> "clang object code"

// clang compilation of C code
"clang compiler" [ label="Clang compiler" ]
"clang AST" [ shape=box ]
"scan-build" -> "clang compiler"
"clang frontend" [ label="Clang frontend" ]
"clang frontend" -> "c code" [ dir=back ]
//"clang frontend" -> "clang AST"
"clang AST" -> "clang frontend" [ dir=back ]
"clang compiler" -> "clang frontend"
"clang compiler" -> "clang AST"  [ dir=back ]
"clang compiler" -> "llvm"

// clang++ compilation of C++ code
"clang compiler" [ label="Clang++ compiler" ]
"scan-build" -> "clang++ compiler"
"clang++ frontend" [ label="Clang++ frontend" ]
"clang++ frontend" -> "cpp code" [ dir=back ]
//"clang++ frontend" -> "clang AST"
"clang AST" -> "clang++ frontend" [ dir=back ]
"clang++ compiler" -> "clang++ frontend"
"clang++ compiler" -> "clang AST"  [ dir=back ]
"clang++ compiler" -> "llvm"

// clang analysis
"clang analysis results" [ shape="box" ]
"scan-build" -> "clang static analyzer"
"clang static analyzer" -> "clang checkers"
"clang checkers" -> "clang analysis results"
"clang checkers" -> "clang AST" [ dir=back ]

// clang C code analysis
"clang static analyzer" -> "clang frontend"

// clang C++ code analysis
"clang static analyzer" -> "clang++ frontend"

// callers analysis
"metadata json file" [ label="Callers metadata\njson files" ]
"metadata json file" [ shape="box" ]

// callers C code analysis
"scan-callers" -> "callers frontend"
"callers frontend" -> "clang frontend"
"callers frontend" -> "metadata json file"

// callers C++ code analysis
"scan-callers" -> "callers++ frontend"
"callers++ frontend" -> "clang++ frontend"
"callers++ frontend" -> "metadata json file"

// callers backends
"metadata json file" -> "Callers backends"
"user config" -> "Callers backends"
"Callers backends" -> "function callgraphs"

// frama-c++
"scan-callers" -> "frama-c++"
"frama-c++" [ label="frama-c++" ]
"frama-c++" -> "clang++ frontend"
"frama-c++" -> "framaCIRGen"
"frama-c++" -> "frama-clang"

// frama-clang analysis
//"scan-callers" -> "frama-clang"
"cmake-callers" -> "frama-clang"
"frama-clang" [ label="frama-clang" ]
"framaCIRGen" [ label="framaCIRGen" ]
//"fir" [ label="Frama-C Intermediate\nRepresentation", shape=box ]
"fir" [ label="Frama-C IR", shape=box ]
"cabs" [ label = "C Abstract", shape=box ]
//"cil" [ label = "C Intermediate Language" ]
"cil" [ label = "CIL", shape=box ]

"clang AST" -> "framaCIRGen" 
//"framaCIRGen" -> "fir"
"fir" -> "framaCIRGen" [ dir=back ]
"fir" -> "frama-clang"
//"frama-clang" -> "cabs"
"cabs" -> "frama-clang" [ dir=back ]
"cabs" -> "frama-c"

// security analysis plugins
"fc security plugins" [ label="STANCE frama-c\nsecurity plugins" ]
"fc security plugins" -> "VA"
"fc security plugins" -> "VA_results" [ dir=back ]

// frama-c value analysis
"VA_results" [ shape=box ]
"VA" [ label="Value Analysis" ]
"VA_results" [ label="VA results" ]
"VA" -> "frama-c" [ dir=back ]
//"VA" -> "VA_results"
"VA_results" -> "VA" [ dir=back ]
"VA" -> "cil" [ dir=back ]

// frama-c analysis
"pp C code" [ shape=box ]
"frama-c" [ label="frama-c" ]
"frama-c" -> "c code" [ dir=back ]
//"c code" -> "frama-c"
"cil" -> "frama-c"
"cil" -> "frama-c" [ dir=back ]
//"frama-c" -> "pretty-printed c code" [ label="print" ]
"frama-c" -> "pp C code" [ label="print" ]
//"frama-c" -> "c code" [ label="print" ]

}

// Local Variables:
// compile-command: "dot -Tpng callers.frontend.internals.gen.dot > callers.frontend.internals.gen.png"
// End:
    #+END_SRC
*** TODO usage of other plug-ins
*** TODO special requirements such as libraries or external tools, etc.
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
* Implementation
   TBC
   #+END_SRC
** TODO Example [0/1]
   - [ ] Illustrate the functioning of the plug-in through a small example (source code, steps to analyse it, results and interpretation of results).
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
* Example
   TBC
   #+END_SRC
** TODO Requirements and availability [0/2]
   Describe
   1. [ ] the requirements for compiling, installing and using the plug-in
   2. [ ] the location (URL) where it can be downloaded with its documentation and 3) the support (versions of Frama-C supported, plans for future support, integration into Frama-C distro, etc.)
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
* Requirements and availability
   TBC
   #+END_SRC
** TODO References [0/1]
   - [ ] Add some references
   #+BEGIN_SRC org :tangle callers.chap6.tcs.D4.2.2.gen.org
* References
  The clang/LLVM online documentation is available at url http://clang.llvm.org.
   #+END_SRC
